{% extends 'base.html' %}
{% load highlight %}
{% load fb_versions %}

{% block search %} {% endblock %}

{% block title %}
  Search {{block.super}}
{% endblock %}


{% block content %}

  <div class="container search-page">
    <div class="search-results">
      {% if query %}
        <div class="search-results__header">
	  <h1>Search results</h1>
          <p>
            {% if method == "DATE" %}
              Results are sorted by publication date.
              <a href="?q={{query}}&page={{page.number}}&method=RELEVANCE">
                Sort by relevance.
              </a>
            {% else %}
              Results are sorted by relevance.
              <a href="?q={{query}}&page={{page.number}}&method=DATE">
                Sort by publication date.
              </a>
            {% endif %}
          </p>
        </div>
        {% include "search/advanced_search.html" %}
        <div class="search-results__body">
	  {% for article in page.object_list %}
            {% if article.obj_type == 0 %}
              <div class="search-result">
                <div class="search-result__image">
                  <img src="{{ article.cached_summary_image }}" />
                </div>
                <div class="search-result__details">
                  <p>{{article.published|date:"j F Y"}}</p>
                  <a href="{% url "article.detail" article.slug %}"><h2>{{ article.title|safe }}</h2></a>
                  <h3>{{ article.subtitle|safe }}</h3>
                </div>
              </div>
            {% elif article.obj_type == 1 %}
              <div class="search-result">
                <div class="search-result__image">
                  <img src="{% version article.cached_summary_image 'medium' %}"
                       alt="{{ article.subtitle }}" />
                </div>
                <div class="search-result__details">
                  <p>{{article.published|date:"j F Y"}}</p>
                  <a href="{% url "photo.detail" article.pk %}">
                    <h2>{{ article.title|safe }}</h2>
                  </a>
                </div>
              </div>
            {% endif %}
	  {% empty %}
	    <p>No results found.</p>
	  {% endfor %}

	  {% block pagination %}
	    {% include 'paginator.html' with page_obj=page query=query %}
	  {% endblock %}
        </div>
      {% else %}
        <div class="search-results__header">
          <h2>Please enter text to search for.</h2>
        </div>
        <div class="search-results__body">
          {% include "search/advanced_search.html" %}
        </div>
      {% endif %}
    </div>
  </div>
  </div>
{% endblock %}
