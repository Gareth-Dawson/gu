{% extends 'base.html' %}
{% load highlight %}

{% block search %} {% endblock %}

{% block title %}
  Search {{block.super}}
{% endblock %}


{% block content %}

  <div class="container search-page">
    <div class="search-results">
      {% if query %}
        <div class="search-results__header">
	  <h1>Search results</h1>
          <p>
            {% if method == "DATE" %}
              Results are sorted by publication date.
              <a href="?q={{query}}&page={{page.number}}&method=RELEVANCE">
                Sort by relevance.
              </a>
            {% else %}
              Results are sorted by relevance.
              <a href="?q={{query}}&page={{page.number}}&method=DATE">
                Sort by publication date.
              </a>
            {% endif %}
          </p>
        </div>
        <div class="adv-filter-box">
          <form class="adv-filter-form">
            <div class="adv-filter-form__row">
              <div class="adv-filter__item adv-filter__search-box">
                {{ adv_search_form.adv_search }}
              </div>
              <div class="adv-filter__item adv-filter__search-type-box">
                {{ adv_search_form.search_type }}
              </div>
            </div>
              <div class="adv-filter-form__row">
              <div class="adv-filter__item adv-filter__category-box">
                <label for="{{ adv_search_form.category.id_for_label }}" >Category:</label>
                {{ adv_search_form.category }}
              </div>
              <div class="adv-filter__item adv-filter__topics-box">
                <label for="{{ adv_search_form.topics.id_for_label }}" >Topics:</label>
                {{ adv_search_form.topics }}
              </div>
            </div>
            <div class="adv-filter-form__row">
              <div class="adv-filter__item adv-filter__date-from-box">
                <label for="{{ adv_search_form.date_from.id_for_label }}" >Date From:</label>
                {{ adv_search_form.date_from }}
              </div>
              <div class="adv-filter__item adv-filter__date-to-box">
                <label for="{{ adv_search_form.date_to.id_for_label }}" >Date To:</label>
                {{ adv_search_form.date_to }}
              </div>
            </div>
            <button class="adv-filter-submit" type="submit">SEARCH</button>
          </form>
        </div>
        <div class="search-results__body">
	  {% for article in page.object_list %}
	    <h2>
	      <a href="{{ article.get_absolute_url }}">{{ article.title|safe }}</a>
	    </h2>
	    <p>
	      {{article.published|date:"j M Y"}}
	    </p>
            <p>
              {% with article.body|safe as body %}
		{% highlight body with query %}
	      {% endwith %}
            </p>
	  {% empty %}
	    <p>No results found.</p>
	  {% endfor %}


	  {% block pagination %}
	    {% include 'paginator.html' with page_obj=page query=query %}
	  {% endblock %}
        </div>
      {% else %}
        <div class="search-results__body">
          <h2>Please enter text to search for.</h2>
        </div>
      {% endif %}
    </div>
  </div>
  </div>
{% endblock %}
